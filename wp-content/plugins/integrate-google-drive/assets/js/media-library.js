(()=>{var e={155:e=>{var t,n,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,l=[],d=!1,s=-1;function u(){d&&c&&(d=!1,c.length?l=c.concat(l):s=-1,l.length&&m())}function m(){if(!d){var e=o(u);d=!0;for(var t=l.length;t;){for(c=l,l=[];++s<t;)c&&c[s].run();s=-1,t=l.length}c=null,d=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||d||o(m)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=React;var t=n.n(e);function i(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=i(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}const r=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=i(e))&&(r&&(r+=" "),r+=t);return r};var a=n(155);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o.apply(this,arguments)}function c(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}var l=(0,e.createContext)({});function d(){return(0,e.useContext)(l)}var s=function(e){return t().createElement(l.Provider,{value:e.refTracker},e.children)};function u(){var e=new Map;return{on:function(t,n){var i;return e.has(t)?null==(i=e.get(t))||i.add(n):e.set(t,new Set([n])),this},off:function(t,n){return n?e.get(t).delete(n):e.delete(t),this},emit:function(t,n){if("production"!==a.env.NODE){var i=t;e.has(t)||0===i||console.error("It seems that the menu you are trying to display is not renderer or you have a menu id mismatch.","You used the menu id: "+t)}return e.has(t)&&e.get(t).forEach((function(e){e(n)})),this}}}var m=u();function f(){return(0,e.useRef)(new Map).current}var p={show:function(e){var t=e.id,n=e.event,i=e.props,r=e.position;n.preventDefault&&n.preventDefault(),m.emit(0).emit(t,{event:n.nativeEvent||n,props:i,position:r})},hideAll:function(){m.emit(0)}};function g(e){return{show:function(t,n){p.show({id:(null==n?void 0:n.id)||(null==e?void 0:e.id),props:(null==n?void 0:n.props)||(null==e?void 0:e.props),event:t,position:null==n?void 0:n.position})},hideAll:function(){p.hideAll()}}}function v(){var e,t,n,i,r=new Map,a=!1;function o(){i[e].node.focus()}function c(){return-1!==e||(l(),!1)}function l(){e+1<i.length?e++:e+1===i.length&&(e=0),a&&d(),o()}function d(){if(c()&&!n){var l=r.get(t),d=l.isRoot,s=l.items,u=l.focusedIndex,m=l.parentNode;t.classList.remove("react-contexify__submenu--is-open"),i=s,t=m,d&&(n=!0,r.clear()),a||(e=u,o())}}return{init:function(t){i=t,e=-1,n=!0},moveDown:l,moveUp:function(){-1===e||0===e?e=i.length-1:e-1<i.length&&e--,a&&d(),o()},openSubmenu:function(){if(c()&&e>=0&&i[e].isSubmenu){var l=Array.from(i[e].submenuRefTracker.values()),d=i[e].node;return r.set(d,{isRoot:n,focusedIndex:e,parentNode:t||d,items:i}),d.classList.add("react-contexify__submenu--is-open"),t=d,l.length>0?(e=0,i=l):a=!0,n=!1,o(),!0}return!1},closeSubmenu:d}}var h={fade:"fade",flip:"flip",scale:"scale",slide:"slide"},w=function(){};function y(e){return"function"==typeof e}function A(e){return"string"==typeof e}function b(t,n){return e.Children.map(e.Children.toArray(t).filter(Boolean),(function(t){return(0,e.cloneElement)(t,n)}))}function E(e,t){return y(e)?e(t):e}function _(e,t){return y(t)?o({},e,t(e)):o({},e,t)}var R=function(n){var i,a,l,d=n.id,u=n.theme,p=n.style,g=n.className,h=n.children,y=n.animation,E=void 0===y?"scale":y,R=n.onHidden,S=void 0===R?w:R,F=n.onShown,U=void 0===F?w:F,j=c(n,["id","theme","style","className","children","animation","onHidden","onShown"]),C=(0,e.useReducer)(_,{x:0,y:0,visible:!1,triggerEvent:{},propsFromTrigger:null,willLeave:!1}),x=C[0],O=C[1],B=(0,e.useRef)(null),k=(0,e.useRef)(!1),N=(a=x.visible,l=(0,e.useRef)(),(0,e.useEffect)((function(){l.current=a}),[a]),l.current),P=f(),K=(0,e.useState)((function(){return v()}))[0];function D(e){var t=e.event,n=e.props,i=e.position;t.stopPropagation();var r,a,o=i||(a={x:0,y:0},function(e){return"touchend"===e.type}(r=t)&&r.changedTouches&&r.changedTouches.length>0?(a.x=r.changedTouches[0].clientX,a.y=r.changedTouches[0].clientY):(a.x=r.clientX,a.y=r.clientY),(!a.x||a.x<0)&&(a.x=0),(!a.y||a.y<0)&&(a.y=0),a),c=o.x,l=o.y;setTimeout((function(){O({visible:!0,willLeave:!1,x:c,y:l,triggerEvent:t,propsFromTrigger:n})}),0)}function T(e){var t=e;(void 0===t||2!==t.button&&!0!==t.ctrlKey||"contextmenu"===t.type)&&(!function(e){return!(!e||!(A(e)||"exit"in e&&e.exit))}(E)?O((function(e){return{visible:!e.visible&&e.visible}})):O((function(e){return{willLeave:e.visible}})))}(0,e.useEffect)((function(){return k.current=!0,m.on(d,D).on(0,T),function(){m.off(d,D).off(0,T)}}),[d]),(0,e.useEffect)((function(){k.current&&x.visible!==N&&(x.visible?U():S())}),[x.visible,S,U]),(0,e.useEffect)((function(){x.visible?K.init(Array.from(P.values())):P.clear()}),[x.visible,K,P]),(0,e.useEffect)((function(){if(x.visible){var e=window,t=e.innerWidth,n=e.innerHeight,i=B.current,r=i.offsetWidth,a=i.offsetHeight,o=x.x,c=x.y;o+r>t&&(o-=o+r-t),c+a>n&&(c-=c+a-n),O({x:o,y:c})}}),[x.visible]),(0,e.useEffect)((function(){function e(e){switch(e.preventDefault(),e.key){case"Enter":K.openSubmenu()||T();break;case"Escape":T();break;case"ArrowUp":K.moveUp();break;case"ArrowDown":K.moveDown();break;case"ArrowRight":K.openSubmenu();break;case"ArrowLeft":K.closeSubmenu()}}return x.visible&&(window.addEventListener("resize",T),window.addEventListener("contextmenu",T),window.addEventListener("click",T),window.addEventListener("scroll",T),window.addEventListener("keydown",e),window.addEventListener("blur",T)),function(){window.removeEventListener("resize",T),window.removeEventListener("contextmenu",T),window.removeEventListener("click",T),window.removeEventListener("scroll",T),window.removeEventListener("keydown",e),window.removeEventListener("blur",T)}}),[x.visible,K]);var M,Q,L=x.visible,I=x.triggerEvent,W=x.propsFromTrigger,J=x.x,q=x.y,H=x.willLeave,X=r("react-contexify",g,((i={})["react-contexify__theme--"+u]=u,i),E?A(E)?r(((M={})["react-contexify__will-enter--"+E]=E&&L&&!H,M["react-contexify__will-leave--"+E+" react-contexify__will-leave--'disabled'"]=E&&L&&H,M)):"enter"in E&&"exit"in E?r(((Q={})["react-contexify__will-enter--"+E.enter]=E.enter&&L&&!H,Q["react-contexify__will-leave--"+E.exit+" react-contexify__will-leave--'disabled'"]=E.exit&&L&&H,Q)):null:null),G=o({},p,{left:J,top:q,opacity:1});return t().createElement(s,{refTracker:P},L&&t().createElement("div",Object.assign({},j,{className:X,onAnimationEnd:function(){x.willLeave&&x.visible&&O({visible:!1,willLeave:!1})},style:G,ref:B,role:"menu"}),b(h,{propsFromTrigger:W,triggerEvent:I})))},S=function(e){var n,i=e.children,a=e.className,o=e.style,l=e.triggerEvent,s=e.data,u=e.propsFromTrigger,m=e.onClick,f=void 0===m?w:m,p=e.disabled,g=void 0!==p&&p,v=e.hidden,h=void 0!==v&&v,y=c(e,["children","className","style","triggerEvent","data","propsFromTrigger","onClick","disabled","hidden"]),A=d(),b={data:s,triggerEvent:l,props:u},_=E(g,b);if(E(h,b))return null;var R=r("react-contexify__item",a,((n={})["react-contexify__item--disabled"]=_,n));return t().createElement("div",Object.assign({},y,{className:R,style:o,onClick:function(e){b.event=e,_?e.stopPropagation():f(b)},onKeyDown:function(e){"Enter"===e.key&&(b.event=e,f(b))},ref:function(e){e&&!_&&A.set(e,{node:e,isSubmenu:!1})},tabIndex:-1,role:"menuitem","aria-disabled":_}),t().createElement("div",{className:"react-contexify__item__content"},i))};function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,c=[],l=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(c.push(i.value),c.length!==t);l=!0);}catch(e){d=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(d)throw r}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function j(e){var t;return!e.type||("application/vnd.google-apps.folder"===e.type||"application/vnd.google-apps.folder"===(null===(t=e.shortcutDetails)||void 0===t?void 0:t.targetMimeType))}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:igd.activeAccount,n=t.root_id,i=t.id,r=[{accountId:i,id:n,name:wp.i18n.__("My Drive","integrate-google-drive"),type:"application/vnd.google-apps.folder",iconLink:"".concat(igd.pluginUrl,"/assets/images/my-drive.svg")},{accountId:i,id:"shared-drives",name:wp.i18n.__("Shared Drives","integrate-google-drive"),type:"application/vnd.google-apps.folder",iconLink:"".concat(igd.pluginUrl,"/assets/images/shared-drives.svg")},{accountId:i,id:"computers",name:wp.i18n.__("Computers","integrate-google-drive"),type:"application/vnd.google-apps.folder",iconLink:"".concat(igd.pluginUrl,"/assets/images/computers.svg")},{accountId:i,id:"shared",name:wp.i18n.__("Shared with me","integrate-google-drive"),type:"application/vnd.google-apps.folder",iconLink:"".concat(igd.pluginUrl,"/assets/images/shared.svg")},{accountId:i,id:"starred",name:wp.i18n.__("Starred","integrate-google-drive"),type:"application/vnd.google-apps.folder",iconLink:"".concat(igd.pluginUrl,"/assets/images/starred.svg")}];return e?r.find((function(t){return t.id==e})):r}function x(e,t){e.onerror=null;var n="https://www.gravatar.com/avatar/"+t+"?s=200&d=mm";e.src===n?e.src="data:image/jpeg;base64,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":e.src=n}function O(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))}function B(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"550",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"600",n=window.screenLeft||window.screenX,i=window.screenTop||window.screenY,r=n+(window.innerWidth||document.documentElement.clientWidth||screen.width)/2-e/2,a=i+(window.innerHeight||document.documentElement.clientHeight||screen.height)/2-t/2,o=window.open(igd.authUrl,"newwindow","width=".concat(e,",height=").concat(t,",left=").concat(r,",top=").concat(a));o.focus&&o.focus()}var N=window.ReactTooltip,P=wp.i18n.__,K=React.useEffect;function D(e){var t=e.activeAccount,n=e.setActiveAccount;K((function(){N.rebuild()}),[]);var i="igd-media-accounts-wrap-".concat(Math.floor(1e3*Math.random()));return React.createElement("div",{className:"igd-media-accounts-wrap"},React.createElement("div",{className:"igd-media-account","data-tip":!0,"data-for":i,onClick:function(e){e.stopPropagation()}},React.createElement("img",{referrerPolicy:"no-referrer",className:"user-image",src:t.photo,onError:function(e){return x(e.currentTarget,t.email)}}),React.createElement("svg",{className:"user-arrow",width:"16",height:"10",viewBox:"0 0 16 10",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M15 1.5L8 8.5L1 1.5",stroke:"#757575",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))),React.createElement(N,{id:i,place:"bottom",type:"light",effect:"solid",event:"click",globalEventOff:"click",clickable:!0,border:!0,borderColor:"#ddd",resizeHide:!1,className:"igd-media-account-modal-wrap igd-tooltip"},React.createElement("div",{className:"igd-media-account-modal",onClick:function(e){e.stopPropagation()}},React.createElement("span",{className:"igd-media-account-modal-title"},P("Switch Account","integrate-google-drive")),Object.keys(igd.accounts).map((function(e){var i=igd.accounts[e],r=i.id,a=i.name,o=i.photo,c=i.email,l=t.id===r;return React.createElement("div",{key:e,className:"account-item ".concat(l?"active":""),onClick:function(t){t.stopPropagation(),n(igd.accounts[e])}},React.createElement("img",{referrerPolicy:"no-referrer",onError:function(e){return x(e.currentTarget,c)},src:o}),React.createElement("div",{className:"account-info"},React.createElement("span",{className:"account-name"},a),React.createElement("span",{className:"account-email"},c)),l&&React.createElement("i",{className:"dashicons dashicons-saved active-badge"}))})),React.createElement("button",{className:"igd-btn btn-primary",onClick:function(e){e.stopPropagation(),igd.authUrl?k():window.location=igd.adminUrl+"/admin.php?page=integrate-google-drive-settings"}},React.createElement("i",{className:"dashicons dashicons-plus"}),React.createElement("span",null,wp.i18n.__("Add account","integrate-google-drive"))))))}var T=React,M=T.useEffect,Q=T.useRef,L=ReactDOM.createPortal;const I=function(e){var t=e.children,n=Q(document.createElement("div"));return M((function(){return document.body.appendChild(n.current),function(){return document.body.removeChild(n.current)}}),[]),L(t,n.current)};var W=React.createContext();const J=W;var q=W.Provider;function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function X(e){return function(e){if(Array.isArray(e))return $(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Z(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e,t,n){var i;return i=function(e,t){if("object"!=H(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=H(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==H(i)?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,c=[],l=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(c.push(i.value),c.length!==t);l=!0);}catch(e){d=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(d)throw r}}return c}}(e,t)||Z(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){if(e){if("string"==typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$(e,t):void 0}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ee=React,te=ee.useState,ne=ee.useEffect;function ie(e){var t=e.fileIds,n=e.activeAccount,i=e.initFolders;n||(n=igd.activeAccount);var r=V(te(null),2),a=r[0],o=r[1],c=V(te(null),2),l=c[0],d=c[1],s=V(te(null),2),u=s[0],m=s[1],f=V(te([]),2),p=f[0],g=f[1],v=V(te(!1),2),h=v[0],w=v[1];function y(e){return o(e.id),wp.ajax.post("igd_get_files",{data:{folder:e}}).done((function(t){var n=t.files;n=n.filter((function(e){return j(e)})),d((function(t){return Y(Y({},t),{},z({},e.id,n))}))})).fail((function(e){console.log(e)})).always((function(){o(null)}))}ne((function(){var e={id:n.root_id,accountId:n.id};y(e).then((function(t){g([e])}))}),[]);var A=!!u&&t.includes(u.id);u&&["computers","shared","starred","shared-drives"].includes(u.id)&&(A=!0);var b=C(!1,n);return i&&(b=i.filter((function(e){return j(e)}))),React.createElement("div",{className:"move-folders-wrap"},React.createElement("div",{className:"move-folders"},b.map((function(e){var t=e.id,n=e.name,i=e.iconLink,r=p.find((function(e){return e.id===t})),o=!!u&&u.id===t,c=function(t){t.stopPropagation(),r?g(p.filter((function(t){return t.id!==e.id}))):(l[e.id]||y(e),g([].concat(X(p),[e])))};return React.createElement(React.Fragment,null,React.createElement("div",{key:t,className:"move-folder ".concat(o?"active":""),onClick:function(n){["computers","shared","starred","shared-drives"].includes(t)?c(n):m(o?null:e)}},React.createElement("i",{className:"dashicons dashicons-arrow-".concat(r?"down":"right"),onClick:c}),React.createElement("img",{src:i,alt:n}),!["computers","shared","starred","shared-drives"].includes(t)&&React.createElement("div",{className:"file-item-checkbox ".concat(o?"checked":"")},React.createElement("span",{className:"box"})),React.createElement("span",null,n),a===t&&React.createElement("div",{className:"igd-spinner"})),r&&React.createElement(re,{folders:l[t]?l[t]:[],childFolders:l,selectedFolder:u,setSelectedFolder:m,getFolders:y,openFolders:p,setOpenFolders:g,loading:a}))}))),React.createElement("button",{disabled:A,type:"button",className:"igd-btn ".concat(A?"disabled":"btn-primary"),onClick:function(){u&&(w(!0),wp.ajax.post("igd_media_upload_attachment",{file_ids:t,folder:u}).done((function(e){Swal.fire({title:wp.i18n.__("Success","integrate-google-drive"),text:wp.i18n.__("File uploaded successfully!","integrate-google-drive"),icon:"success",toast:!0,showConfirmButton:!1,timer:2e3,timerProgressBar:!0,customClass:{container:"igd-swal"}}),e.length&&e.forEach((function(e){wp.ajax.post("igd_file_uploaded",{file:Y(Y({},e),{},{type:e.mimeType,accountId:u.accountId})})}))})).fail((function(e){console.error("Upload failed:",e),Swal.fire({title:wp.i18n.__("Error","integrate-google-drive"),text:wp.i18n.__("Something went wrong!","integrate-google-drive"),icon:"error",toast:!0,showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:{container:"igd-swal"}})})).always((function(){w(!1)})))}},h&&React.createElement("div",{className:"igd-spinner"}),h?wp.i18n.__("Uploading...","integrate-google-drive"):wp.i18n.__("Upload","integrate-google-drive")))}function re(e){var t=e.folders,n=e.childFolders,i=e.selectedFolder,r=e.setSelectedFolder,a=e.getFolders,o=e.openFolders,c=e.setOpenFolders,l=e.loading;return t.length?t.map((function(e){var t=o.find((function(t){return t.id===e.id})),d=!!i&&i.id===e.id;return React.createElement("div",{key:e.id,className:"move-folder-wrap"},React.createElement("div",{className:"move-folder ".concat(d?"active":""),onClick:function(){r(d?null:e)}},React.createElement("i",{className:"dashicons dashicons-arrow-".concat(t?"down":"right"),onClick:function(i){i.stopPropagation(),t?c(o.filter((function(t){return t.id!==e.id}))):(n[e.id]||a(e),c([].concat(X(o),[e])))}}," "),React.createElement("img",{src:e.iconLink,alt:e.name}),React.createElement("div",{className:"file-item-checkbox ".concat(d?"checked":"")},React.createElement("span",{className:"box"})),React.createElement("span",null,e.name),l===e.id&&React.createElement("div",{className:"igd-spinner"})),t&&n[e.id]&&React.createElement(re,{folders:n[e.id],childFolders:n,getFolders:a,setSelectedFolder:r,selectedFolder:i,openFolders:o,setOpenFolders:c,loading:l}))})):!l&&React.createElement("div",{className:"move-folder-wrap empty"},React.createElement("i",{className:"dashicons dashicons-warning"}),React.createElement("span",null,wp.i18n.__("No folders found!","integrate-google-drive")))}function ae(e){var t=e.google_drive_file;Swal.fire({title:"Importing ".concat(t.name),text:wp.i18n.__("Please wait import is in progress.","integrate-google-drive"),icon:"info",showConfirmButton:!1,allowEscapeKey:!1,allowEnterKey:!1,allowOutsideClick:!1,customClass:{container:"igd-swal igd-media-swal-import"},didOpen:function(){Swal.showLoading(),wp.ajax.send("igd_import_media",{data:{files:[t]},success:function(e){Swal.fire({title:wp.i18n.__("Imported!","integrate-google-drive"),text:wp.i18n.__("The file has been imported.","integrate-google-drive"),icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,toast:!0,customClass:{container:"igd-swal igd-media-swal-import"}})},error:function(e){console.log(e),Swal.fire({title:wp.i18n.__("Error!","integrate-google-drive"),text:wp.i18n.__("There was an error importing the file.","integrate-google-drive"),icon:"error",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,toast:!0,customClass:{container:"igd-swal igd-media-swal-import"}})}})}})}function oe(e){var t=wp.media({title:wp.i18n.__("Select Replacement","integrate-google-drive"),button:{text:wp.i18n.__("Select","integrate-google-drive")},multiple:!1});t.$el.addClass("igd-media-replace-frame"),t.on("select",(function(){var n=t.state().get("selection").first().toJSON();n.mime===e.mime?wp.ajax.post("igd_media_replace_attachment",{old_attachment_id:e.id,new_attachment_id:n.id}).done((function(){Swal.fire({title:wp.i18n.__("File Replaced","integrate-google-drive"),text:wp.i18n.__("The file has been replaced with the selected Google Drive file.","integrate-google-drive"),icon:"success",toast:!0,timer:3e3,showConfirmButton:!1,customClass:{container:"igd-swal"}}),le(e,"replace")})).fail((function(e){console.log(e),Swal.fire({title:wp.i18n.__("Error","integrate-google-drive"),text:wp.i18n.__("There was an error replacing the file.","integrate-google-drive"),icon:"error",customClass:{container:"igd-swal"}})})):Swal.fire({title:wp.i18n.__("File type mismatch","integrate-google-drive"),text:wp.i18n.__("The selected file type must match the type of the file you are replacing.","integrate-google-drive"),icon:"error",customClass:{container:"igd-swal"}})})).open()}function ce(e){wp.ajax.post("igd_media_restore_attachment",{attachment_id:e.id}).done((function(){Swal.fire({title:wp.i18n.__("File Restored","integrate-google-drive"),text:wp.i18n.__("File has been restored to the original media library attachment.","integrate-google-drive"),icon:"success",toast:!0,timer:3e3,showConfirmButton:!1,customClass:{container:"igd-swal"}}),le(e,"restore")})).fail((function(e){console.log(e)}))}function le(e,t){var n=jQuery;wp.media.attachment(e.id).fetch().then((function(i){var r=n(".attachment-details"),a=r.find('input[name^="attachments["]').attr("name"),o=null==a?void 0:a.match(/attachments\[(\d+)\]\[menu_order\]/),c=o?o[1]:null;c==e.id&&(r.find(".details-image").attr("src",i.sizes.full.url),r.find(".attachment-details-copy-link").val(i.url),"replace"===t?(r.find(".compat-field-igd_media_upload").addClass("igd-hidden"),r.find(".igd-media-action-replace").replaceWith('<button type="button" class="button igd-media-action igd-media-action-restore" data-action="restore" data-attachment_id="'.concat(c,'"><i class="dashicons dashicons-image-rotate"></i>').concat(wp.i18n.__("Restore","integrate-google-drive"),"</button>"))):"restore"===t&&(r.find(".compat-field-igd_media_upload").removeClass("igd-hidden"),r.find(".igd-media-action-restore").replaceWith('<button type="button" class="button igd-media-action igd-media-action-replace" data-action="replace" data-attachment_id="'.concat(c,'"><i class="dashicons dashicons-update-alt"></i>').concat(wp.i18n.__("Replace","integrate-google-drive"),"</button>"))))}))}function de(e){Swal.fire({title:wp.i18n.__("Select Upload Folder","integrate-google-drive"),text:wp.i18n.__("Select destination","integrate-google-drive"),html:'<div id="igd-media-upload"></div>',showCancelButton:!1,showConfirmButton:!1,showCloseButton:!0,customClass:{container:"igd-swal igd-media-upload-swal"},didOpen:function(t){var n=document.getElementById("igd-media-upload");ReactDOM.render(React.createElement(ie,{fileIds:[e.id]}),n)},willClose:function(){var e=document.getElementById("igd-media-upload");ReactDOM.unmountComponentAtNode(e)}})}function se(e){var t=new URL(window.location.href);for(var n in e)t.searchParams.set(n,e[n]);window.location.href=t.href}function ue(e){var t=igd.settings,n=t.mediaExcludesFolders,i=void 0===n?[]:n,r=t.mediaExcludesAllFolders,a=void 0!==r&&r,o=t.mediaExcludesExceptFolders;return a?!(void 0===o?[]:o).some((function(t){return t.id===e.id&&t.accountId===e.accountId})):i.some((function(t){return t.id===e.id&&t.accountId===e.accountId}))}function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e,t,n){var i;return i=function(e,t){if("object"!=me(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=me(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==me(i)?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ve=React.useContext;function he(){var e="upload-list"===igdMedia.pageType,t=ve(J),n=t.activeFolder,i=t.setActiveFolder,r=t.getChildFolders,a=[{key:"refresh",title:wp.i18n.__("Refresh","integrate-google-drive"),icon:"dashicons-update-alt"}];return React.createElement(I,null,React.createElement(R,{id:"igd-media-context-menu",className:"igd-context-menu",animation:h.fade},a.map((function(t){var a=t.key,o=t.title,c=t.icon;return React.createElement(S,{key:a,onClick:function(t){t.data,t.event,t.triggerEvent;if("refresh"===a){if(e)return void se({folder_id:n.id,account_id:n.accountId,is_refresh:!0});i(pe(pe({},n),{},{isRefresh:!0})),r(pe(pe({},n),{},{isRefresh:!0}))}},data:{action:a},className:"context-menu-item ".concat(a),disabled:!1},React.createElement("i",{className:"dashicons ".concat(c)}),React.createElement("span",null,o))}))))}function we(e){return function(e){if(Array.isArray(e))return ye(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Ae=React.useContext;function be(e){var t=e.folders,n=e.isSub,i="upload-list"===igdMedia.pageType,r=Ae(J),a=r.activeFolder,o=r.setActiveFolder,c=r.showContextMenu,l=r.isLoading,d=r.childFolders,s=r.openFolders,u=r.setOpenFolders,m=r.getChildFolders,f=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(e.stopPropagation(),"application/vnd.google-apps.shortcut"===t.type)&&(t.id=null===(n=t.shortcutDetails)||void 0===n?void 0:n.targetId);if(r)s.find((function(e){return t.id===e.id}))?u((function(e){return e.filter((function(e){return t.id!==e.id}))})):u((function(e){return[].concat(we(e),[t])}));else{if(i)return void se({folder_id:t.id,account_id:t.accountId});o(t),u((function(e){return[].concat(we(e),[t])}))}s.find((function(e){return t.id===e.id}))||null!=d&&d.id||d[null==t?void 0:t.id]||m(t)};return React.createElement("div",{className:"".concat(n?"sub-item":"tree-main")},t.map((function(e){var t=e.id,n=e.name,i=e.iconLink,r=t===(null==a?void 0:a.id),o=s.find((function(t){return t.id===e.id}));return React.createElement("div",{className:"tree-item-wrap"},React.createElement("div",{key:t,className:"".concat(r?"active":""," tree-item folder-item"),onClick:function(t){return f(t,e)},onContextMenu:function(e){e.preventDefault(),c(e)}},l!==t&&(!r||!!d[t])&&React.createElement("i",{className:"dashicons ".concat(o?"dashicons-arrow-down":"dashicons-arrow-right"),onClick:function(t){return f(t,e,!0)}}),l===t&&React.createElement("div",{className:"igd-spinner"}),React.createElement("img",{src:i,alt:n}),React.createElement("span",null,n)),o&&d[t]&&React.createElement(be,{folders:d[t],isSub:!0}))})))}var Ee=React,_e=Ee.useEffect,Re=Ee.useRef,Se=Ee.useContext,Fe=ReactDOM.createPortal,Ue=function(e){var t=e.frame,n=e.children,i=Re(document.createElement("div"));return _e((function(){t.find(".igd-media-folders").remove();var e=t.find(".attachments-wrapper");if(e.length)return i.current.classList.add("igd-media-folders"),e.prepend(i.current),function(){jQuery(i.current).remove()}}),[]),Fe(n,i.current)};function je(){var e=Se(J),t=e.frame,n=e.activeFolder,i=e.setActiveFolder,r=e.getChildFolders,a=e.childFolders;return React.createElement(Ue,{frame:t},a[null==n?void 0:n.id].map((function(e){return React.createElement("div",{key:e.id,className:"igd-media-folder ".concat(e.id===(null==n?void 0:n.id)?"active":""),onClick:function(){i(e),r(e)}},React.createElement("img",{src:e.iconLink,alt:e.name,width:24,height:24}),React.createElement("div",{className:"igd-media-folder-name"},e.name))})))}function Ce(){return React.createElement("div",{className:"no-account-placeholder"},React.createElement("img",{src:"".concat(igd.pluginUrl,"/assets/images/file-browser/no-account-placeholder.svg"),alt:"No Accounts"}),React.createElement("span",{className:"placeholder-heading"},wp.i18n.__("You didn't link any account yet.","integrate-google-drive")),React.createElement("span",{className:"placeholder-description"},wp.i18n.__("Please link to a Google Drive account to continue.","integrate-google-drive")),React.createElement("button",{className:"igd-btn add-account-btn",onClick:function(){igd.authUrl?k():window.location=igd.adminUrl+"/admin.php?page=integrate-google-drive-settings&tab=accounts"}},React.createElement("img",{src:"".concat(igd.pluginUrl,"/assets/images/google-icon.png")}),React.createElement("span",null,wp.i18n.__("Sign in with Google","integrate-google-drive"))))}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,c=[],l=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(c.push(i.value),c.length!==t);l=!0);}catch(e){d=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(d)throw r}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Be=React,ke=Be.useState,Ne=Be.useEffect,Pe=Be.useContext;Be.useRef;const Ke=function(){var e=jQuery,t=(Pe(J).activeAccount,xe(ke(null),2)),n=t[0],i=t[1],r=g({id:"igd-media-item-context-menu"}),a=r.show;r.hideAll,Ne((function(){return e(document).on("contextmenu",".attachments-wrapper .attachment",(function(t){t.preventDefault();var n=wp.media.attachment(e(this).attr("data-id")).toJSON();i(n),a(t,{props:{attachment:n}})})),function(){e(document).off("contextmenu",".attachment")}}),[]);var o=!(null==n||!n.google_drive_file),c=!(null==n||!n.igd_media_replace_id),l=[o&&!c&&{key:"import",title:wp.i18n.__("Import to Media Library","integrate-google-drive"),icon:"dashicons-download"},!o&&!c&&{key:"replace",title:wp.i18n.__("Replace with Google Drive","integrate-google-drive"),icon:"dashicons-update-alt"},!!c&&{key:"restore",title:wp.i18n.__("Restore Original","integrate-google-drive"),icon:"dashicons-image-rotate"},!o&&{key:"upload",title:wp.i18n.__("Upload to Google Drive","integrate-google-drive"),icon:"dashicons-upload"}];return React.createElement(I,null,React.createElement(R,{id:"igd-media-item-context-menu",className:"igd-context-menu"},l.filter(Boolean).map((function(e){var t=e.key,i=e.title,r=e.icon;return React.createElement(S,{key:t,onClick:function(e){e.data,e.event,e.triggerEvent;"import"===t?ae(n):"upload"===t?de(n):"replace"===t?oe(n):"restore"===t&&ce(n)},data:{action:t},className:"context-menu-item ".concat(t),disabled:!1},React.createElement("i",{className:"dashicons ".concat(r)}),React.createElement("span",null,i))}))))};function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Te(e){return function(e){if(Array.isArray(e))return Je(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||We(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){Le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e,t,n){var i;return i=function(e,t){if("object"!=De(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=De(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==De(i)?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,c=[],l=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(c.push(i.value),c.length!==t);l=!0);}catch(e){d=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(d)throw r}}return c}}(e,t)||We(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(e,t){if(e){if("string"==typeof e)return Je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Je(e,t):void 0}}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var qe=React,He=qe.useState,Xe=qe.useEffect,Ge=qe.useRef,Ye=igd.settings,ze=Ye.mediaExcludesAllFolders,Ve=void 0!==ze&&ze,Ze=Ye.mediaExcludesExceptFolders,$e=void 0===Ze?[]:Ze;function et(e){var t,n=e.frame,i=Ge(null),r=!!Object.keys(igd.accounts).length,a="upload-list"===igdMedia.pageType,o=igd.activeAccount||r&&igd.accounts[Object.keys(igd.accounts)[0]];if(a){var c=new URL(window.location.href);if(r){var l=B(c.searchParams.get("account_id"));l&&(o=igd.accounts[l])}c.searchParams.get("is_refresh")&&(c.searchParams.delete("is_refresh"),window.history.replaceState({},"",c))}var d=n.hasClass("igd-media-replace-frame"),s=!a&&JSON.parse(sessionStorage.getItem("igd_media_last_folder"));s&&ue(s)&&(s=null);var u=Ie(He(d||r&&s&&0!=s.id?"google":"media"),2),m=u[0],f=u[1],p=Ie(He(o),2),v=p[0],h=p[1],w=C(!1,v).filter((function(e){return"starred"!==e.id}));w=Ve?$e:w.filter((function(e){return!ue(e)}));var y="google"===m&&(!d&&s||w[0]),A=Ie(He(y||a&&igd.activeFolder),2),b=A[0],E=A[1],_=Ie(He(!1),2),R=_[0],S=_[1],U=Ie(He({}),2),x=U[0],k=U[1],N=Ie(He([]),2),P=N[0],K=N[1],T=function(e){return S(e.id),wp.ajax.post("igd_get_files",{data:{folder:e,refresh:e.isRefresh}}).done((function(t){var n=t.files;n=n.filter((function(e){return j(e)&&(Ve||!ue(e))})),k((function(t){return Qe(Qe({},t),{},Le({},e.id,n))})),e.isRefresh&&igdMedia.reloadAttachments()})).fail((function(e){console.log(e),S(null)})).always((function(){S(null)}))},M=function(e){return S(e.id),wp.ajax.post("igd_media_get_parent_folders",{folder:e}).done((function(e){0!==Object.keys(e).length&&Object.keys(e).forEach((function(t){var n=e[t].folder;K((function(e){return[].concat(Te(e),[n])}));var i=e[t].children,r=(null==i?void 0:i.filter((function(e){return j(e)&&!ue(e)})))||[];k((function(e){return Qe(Qe({},e),{},Le({},t,r))}))}))})).fail((function(e){console.log(e)})).always((function(){S(null)}))},Q=function(){var e=F(React.useState(!1),2),t=e[0],n=e[1];return React.useEffect((function(){n(!0)}),[]),t}();Xe((function(){!a&&b&&(void 0!==wp.media.view.AttachmentFilters&&(wp.media.view.AttachmentFilters.igd_media_filter=wp.media.view.AttachmentFilters.extend({className:"igd-media-folder-filter",id:"igd-media-folder-filter",createFilters:function(){this.filters=Le({},null==b?void 0:b.id,{text:null==b?void 0:b.name,props:{folder_id:null==b?void 0:b.id,account_id:null==b?void 0:b.accountId,is_refresh:null==b?void 0:b.isRefresh}}),this.model.set("folder_id",null==b?void 0:b.id),this.model.set("account_id",null==b?void 0:b.accountId),this.model.set("is_refresh",null==b?void 0:b.isRefresh)}})),igdMedia.attachmentsBrowser&&igdMedia.attachmentsBrowser.toolbar.set("igd-media-folder-filter",new wp.media.view.AttachmentFilters.igd_media_filter({controller:igdMedia.attachmentsBrowser.controller,model:igdMedia.attachmentsBrowser.collection.props,priority:-75}).render()),d||("google"===m?sessionStorage.setItem("igd_media_last_folder",JSON.stringify(b)):sessionStorage.removeItem("igd_media_last_folder")))}),[m,b]),Xe((function(){if("google"===m)M(b),b&&!x[b.id]&&T(b).then((function(){K((function(e){return[].concat(Te(e),[b])}))}));else if(a&&void 0!==igd.activeFolder){var e=new URL(window.location.href),t=e.searchParams.get("folder_id"),n=e.searchParams.get("account_id");t&&n&&(f("google"),M(igd.activeFolder),T(igd.activeFolder).then((function(){K((function(e){return[].concat(Te(e),[igd.activeFolder])}))})))}}),[]),Xe((function(){Q&&(a?se({folder_id:O(w[0].id),account_id:O(w[0].accountId)}):(igd.activeAccount=v,f("google"),E(w[0]),x[w[0].id]||T(w[0]).then((function(){K((function(e){return[].concat(Te(e),[w[0]])}))}))))}),[v]);var L=g({id:"igd-media-context-menu"}),I=L.show,W=L.hideAll;return r?React.createElement(q,{value:{frame:n,activeAccount:v,setActiveAccount:h,activeFolder:b,setActiveFolder:E,rootFolders:w,setTab:f,tab:m,showContextMenu:I,hideContextMenu:W,isLoading:R,childFolders:x,openFolders:P,setOpenFolders:K,getChildFolders:T}},React.createElement(he,null),!a&&React.createElement(Ke,null),!a&&!(null===(t=x[null==b?void 0:b.id])||void 0===t||!t.length)&&React.createElement(je,null),React.createElement("div",{className:"igd-media-tree",ref:i},!d&&React.createElement("div",{className:"tree-item-wrap"},React.createElement("div",{className:"tree-item tab-item ".concat("media"===m?"active":""),onClick:function(){a?se({folder_id:"",account_id:""}):(f("media"),E({name:wp.i18n.__("Media Library","igd-media-library"),id:"0",accountId:0}))}},React.createElement("i",{className:"tab-icon dashicons dashicons-admin-media"}),React.createElement("span",null,wp.i18n.__("Media Library","igd-media-library")))),React.createElement("div",{className:"tree-item-wrap tree-item-wrap-google"},React.createElement("div",{className:"tree-item tab-item ".concat("google"===m?"active":""),onClick:function(){var e;a?se({folder_id:O(w[0].id),account_id:O(w[0].accountId)}):(f("google"),E(w[0]),K((function(e){return[].concat(Te(e),[w[0]])})),P.find((function(e){return w[0].id===e.id}))||null!=x&&x.id||x[null===(e=w[0])||void 0===e?void 0:e.id]||T(w[0]))}},React.createElement("img",{src:"".concat(igd.pluginUrl,"/assets/images/drive.png"),className:"tab-icon"}),React.createElement("span",null,wp.i18n.__("Google Drive","igd-media-library")),React.createElement(D,{activeAccount:v,setActiveAccount:h})),"google"===m&&React.createElement(be,{folders:w})))):React.createElement("div",{className:"igd-media-tree",ref:i},React.createElement("div",{className:"tree-item-wrap"},React.createElement("div",{className:"tree-item tab-item active",onClick:function(){f("media"),E({name:wp.i18n.__("Media Library","igd-media-library"),id:"0",accountId:0})}},React.createElement("i",{className:"tab-icon dashicons dashicons-admin-media"}),React.createElement("span",null,wp.i18n.__("Media Library","igd-media-library")))),React.createElement("div",{className:"tree-item-wrap tree-item-wrap-google"},React.createElement("div",{className:"tree-item tab-item"},React.createElement("img",{src:"".concat(igd.pluginUrl,"/assets/images/drive.png"),className:"tab-icon"}),React.createElement("span",null,wp.i18n.__("Google Drive","igd-media-library"))),React.createElement(Ce,null)))}function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}!function(e){var t=arguments,n={ready:function(){n.initModule(),e(document).on("click",".igd-media-action-import",(function(){var t=e(this).attr("data-attachment_id");ae(wp.media.attachment(t).toJSON())})),e(document).on("click",".igd-media-action-replace",(function(){var t=e(this).attr("data-attachment_id");oe(wp.media.attachment(t).toJSON())})),e(document).on("click",".igd-media-action-restore",(function(){var t=e(this).attr("data-attachment_id");ce(wp.media.attachment(t).toJSON())})),e(document).on("click",".igd-media-action-upload",(function(){var t=e(this).attr("data-attachment_id");de(wp.media.attachment(t).toJSON())}))},getFrame:function(){return"upload-list"===n.pageType?e(".upload-php #posts-filter"):e('.media-frame.mode-select[id^="__wp-uploader-id-"]:visible').length?e('.media-frame.mode-select[id^="__wp-uploader-id-"]:visible'):e('[id^="__wp-uploader-id-"]:visible div.media-frame')},initModule:function(){"upload.php"===igd.pagenow&&e('#posts-filter input[name="mode"][value="list"]').length&&e("#posts-filter .media").length?n.pageType="upload-list":"upload.php"===igd.pagenow&&e("#wp-media-grid").length&&(n.pageType="upload-grid"),e('.upload-php #posts-filter input[name="mode"][value="list"]').length?n.initTree():("upload-list"!==n.pageType&&n.initFilter(),"undefined"!=typeof wp&&void 0!==wp.media&&void 0!==wp.media.view&&void 0!==wp.media.view.AttachmentsBrowser&&wp.media.view.AttachmentsBrowser.prototype.on("ready",(function(){n.initTree(),"upload-list"!==n.pageType&&n.addAttachmentClass()})));var t=wp.media.controller.FeaturedImage;void 0!==t&&(wp.media.controller.FeaturedImage=wp.media.controller.FeaturedImage.extend({updateSelection:function(){t.prototype.updateSelection.apply(this,arguments),n.initTree()}})),"upload-list"!==n.pageType&&(n.onModalOpen(),n.handleUploader(),n.handleUploadStatus())},handleUploader:function(){var t;void 0!==(null===(t=wp)||void 0===t?void 0:t.Uploader)&&e.extend(wp.Uploader.prototype,{init:function(){var e=this,t=function(){e.uploader.settings.url=_wpPluploadSettings.defaults.url,e.uploader.settings.multipart_params=_wpPluploadSettings.defaults.multipart_params};this.uploader.bind("BeforeUpload",(function(n,i){var r=sessionStorage.getItem("igd_media_last_folder");if(r)try{var a=JSON.parse(r);e.uploader.settings.multipart_params={folder_id:a.id,account_id:a.accountId},e.uploader.settings.url="".concat(igd.ajaxUrl,"?action=igd_media_upload_file&folder_id")}catch(e){console.log(e),t()}else t()})),this.uploader.bind("UploadComplete",n.reloadAttachments)}})},handleUploadStatus:function(){wp.Uploader.queue.on("add",(function(t){var i=t.attributes.file.id;e('.attachment.loading[data-cid="'.concat(i,'"]')).length||void 0===wp.media.frame||void 0===wp.media.frame._state||"featured-image"===wp.media.frame._state||n.getFrame().find(".attachments-browser .attachments").prepend('<li data-cid="'+t.attributes.file.id+'" class="attachment loading"><div class="attachment-preview js--select-attachment type-image subtype-jpeg portrait"><div class="thumbnail"><div class="media-progress-bar"><div style="width:0"></div></div></div></div></li>')})),wp.Uploader.queue.on("reset",(function(){e(".attachment.loading").remove()}));var t=wp.media.view.UploaderStatus;void 0!==t&&(wp.media.view.UploaderStatus=wp.media.view.UploaderStatus.extend({progress:function(n){t.prototype.progress.apply(this,arguments),void 0!==n&&void 0!==n.changed&&void 0!==n.changed.percent&&void 0!==wp.media.frame&&void 0!==wp.media.frame._state&&"featured-image"!==wp.media.frame._state&&e("li.attachment[data-cid="+n.attributes.file.id+"] .media-progress-bar > div").css({width:n.changed.percent+"%"})}}))},initFilter:function(){void 0!==wp.media.view.AttachmentFilters&&(wp.media.view.AttachmentFilters.igd_media_filter=wp.media.view.AttachmentFilters.extend({className:"igd-media-folder-filter",id:"igd-media-folder-filter",createFilters:function(){this.filters={media:{text:"Media Library",props:{folder_id:0,account_id:"",is_refresh:""}}}}}));var e=wp.media.view.AttachmentsBrowser;void 0!==e&&(wp.media.view.AttachmentsBrowser=wp.media.view.AttachmentsBrowser.extend({createToolbar:function(){this.$el.data("backboneView",this),e.prototype.createToolbar.apply(this,arguments),n.attachmentsBrowser=this,this.toolbar.set("igd-media-folder-filter",new wp.media.view.AttachmentFilters.igd_media_filter({controller:this.controller,model:this.collection.props,priority:-75}).render())}}))},initTree:function(){var t=e(".media-modal:visible").length,i=n.getFrame();if("upload-list"===n.pageType||void 0===wp.media.frame||"gallery-edit"!==wp.media.frame._state){if(t||"upload-list"!==n.pageType&&"upload-grid"!==n.pageType){e(window).width(),i.hasClass("hide-menu")&&e(window).width()>768&&i.removeClass("hide-menu");var r=i.find(".media-frame-menu .media-menu");r.length||(r=i.find(".media-frame-menu"),i.find(".media-frame-menu-heading").hide());var a=document.createElement("div");a.className="igd-media-tree-wrap",ReactDOM.render(React.createElement(et,{frame:i}),a),e(window).width()<600?i.find(".igd-media-tree-wrap").length||e(a).insertBefore(e("ul.attachments")):r.find(".igd-media-tree-wrap").length||e(a).appendTo(r),i.find(".igd-media-toggle-actions").length||n.initActionsToggle(i)}else if(!n.getFrame().find(".igd-media-tree-wrap").length){var o=document.createElement("div");o.className="igd-media-tree-wrap",ReactDOM.render(React.createElement(et,{frame:i}),o),e(window).width()<600?e(o).insertBefore(e("ul.attachments")):e(o).insertBefore(e("#wpbody-content"))}}else n.getFrame().find(".igd-media-tree-wrap").length&&(ReactDOM.unmountComponentAtNode(n.getFrame().find(".igd-media-tree-wrap")[0]),n.getFrame().find(".igd-media-tree-wrap").remove())},initActionsToggle:function(e){e.find(".media-frame-menu-heading").append('<i class="igd-media-toggle-actions dashicons dashicons-arrow-down"></i>'),e.find(".media-frame-menu-heading").on("click",(function(){e.find(".media-menu").toggleClass("show-actions")}))},onModalOpen:function(){var t=wp.media.view.Modal;void 0!==t&&(wp.media.view.Modal=wp.media.view.Modal.extend({open:function(){t.prototype.open.apply(this,arguments);var n=e(".attachment-details"),i=n.find('input[name^="attachments["]').attr("name"),r=null==i?void 0:i.match(/attachments\[(\d+)\]\[menu_order\]/),a=r?r[1]:null;if(a&&wp.media.attachment(a).get("igd_media_replace_id")){var o=n.find(".thumbnail");o.addClass("igd-media-replaced"),o.find(".igd-media-replaced-label").length||o.append('<span class="igd-media-replaced-label dashicons dashicons-update-alt" title="'.concat(wp.i18n.__("Replaced with Google Drive","igd-media-library"),'" ></span>'))}}}))},addAttachmentClass:function(){var t=null;n.getFrame().find(".attachments-browser ul.attachments").on("DOMNodeInserted",(function(){clearTimeout(t),t=setTimeout((function(){n.getFrame().find(".attachments-browser ul.attachments .attachment .thumbnail").each((function(t){var n=e(this);if(n.closest(".attachment-preview").hasClass("type-image")&&!n.closest(".attachment.loading").length){var i=n.closest(".attachment").data("id");if(wp.media.attachment(i).get("igd_media_replace_id")){var r=n.closest(".attachment-preview");r.addClass("igd-media-replaced"),r.find(".igd-media-replaced-label").length||r.append('<span class="igd-media-replaced-label dashicons dashicons-update-alt" title="'.concat(wp.i18n.__("Replaced with Google Drive","igd-media-library"),'" ></span>'))}}}))}),300)}))},reloadAttachments:function(){var e=t.length>0&&void 0!==t[0]&&t[0],i=n.getBackboneOfMedia(e);if(i.browser.length>0&&"object"==tt(i.view))try{i.view.collection.props.set({ignore:+new Date})}catch(e){}},getBackboneOfMedia:function(){var i,r=t.length>0&&void 0!==t[0]&&t[0],a=n.getFrame().parents(".media-modal:visible");return i=(a.length>0&&!r?a.find(".attachments-browser"):e(".media-frame-content .attachments-browser")).data("backboneView"),{browser:e(".attachments-browser"),view:i}}};window.igdMedia=n,e(document).ready(n.ready)}(jQuery)})()})();