(()=>{var e,n,o;e=jQuery,n=window.ModuleBuilderModal,o={init:function(){e(".insert-file-row").after('<div class="igd-dokan"><button type="button" class="dokan-btn dokan-btn-default igd-wc-button"><img src="'.concat(igd.pluginUrl,'/assets/images/drive.png" width="20"/><span>').concat(wp.i18n.__("Add File","integrate-google-drive"),"</span></button></div>")),e(document).on("click",".dokan-btn.igd-wc-button",o.handleDokanFileSelector),e(document).on("click",".save-upload-settings",o.saveDokanUploadSettings),e(document).on("click",".dokan-igd-settings .remove-account",o.handleDokanAccountRemove)},handleDokanAccountRemove:function(){var n=this;Swal.fire({title:wp.i18n.__("Are you sure?","integrate-google-drive"),text:wp.i18n.__("You won't be able to revert this!","integrate-google-drive"),icon:"warning",showCancelButton:!0,confirmButtonText:wp.i18n.__("Yes, remove it!","integrate-google-drive"),reverseButtons:!0,showLoaderOnConfirm:!0,customClass:{container:"igd-swal"},preConfirm:function(){var o=e(n).closest(".igd-account-item").data("id");return wp.ajax.post("igd_delete_account",{id:o})}}).then((function(o){o.value&&(e(n).closest(".igd-account-item").remove(),Swal.fire({title:wp.i18n.__("Removed!","integrate-google-drive"),text:wp.i18n.__("Account has been removed.","integrate-google-drive"),icon:"success",showConfirmButton:!1,timer:1500,toast:!0}))}))},handleDokanFileSelector:function(o){var t=e(this).parents(".dokan-download-wrapper");Swal.fire({html:'<div id="igd-select-files" class="igd-module-builder-modal-wrap"></div>',showConfirmButton:!1,customClass:{container:"igd-module-builder-modal-container"},didOpen:function(o){ReactDOM.render(React.createElement(n,{initData:{},onUpdate:function(n){var o=n.folders,i=void 0===o?[]:o,a=t.find("tbody"),d=t.find(".insert-file-row ").data("row");i.map((function(n){var o=n.id,t=n.name,i=n.type,c=n.accountId,s="https://drive.google.com/open?action=igd-wc-download&id=".concat(o,"&account_id=").concat(c,"&name=").concat(t,"&type=").concat(i),l=e(d);l.find('[name="_wc_file_names[]"]').val(t),l.find('[name="_wc_file_urls[]"]').val(s),a.append(l)})),Swal.close()},onClose:function(){return Swal.close()},isSelectFiles:"dokan"}),document.getElementById("igd-select-files"))},willClose:function(e){ReactDOM.unmountComponentAtNode(document.getElementById("igd-select-files"))}})},saveDokanUploadSettings:function(){var n=this;wp.ajax.send("igd_save_dokan_upload_settings",{data:{data:e("#igd-dokan-upload-settings").serialize(),nonce:igd.nonce},beforeSend:function(){e(n).find("i").removeClass("fa-save").addClass("fa-spinner fa-spin")},success:function(n){e(".dokan-igd-ajax-response").show()},error:function(e){console.log(e)},complete:function(){e(n).find("i").removeClass("fa-spin fa-spinner").addClass("fa-save")}})}},e(document).ready(o.init)})();